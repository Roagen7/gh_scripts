if params.len != 1 or params[0] == "-h" then exit("Usage: libexploit [libpath]")

mx = include_lib("/lib/metaxploit.so")
if not mx then 
	mx = include_lib(current_path + "/metaxploit.so")
	if not mx then exit("no metaxploit")
end if


mlib = mx.load(params[0])
if not mlib then exit("no such lib")
sc = mx.scan(mlib)
for s in sc
	print(s + " " + mx.scan_address(mlib,s) + "\n")
end for

exit("--scanned")
